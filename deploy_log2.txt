[RECEPTION ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,
    '          THEN 1 END\n' +
        COUNT(CASE 
    '        ) AS fila,\n' +
          WHEN dt_atendimento IS N' at line 16
    '        unidade_id,\n' +
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    '\n' +
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    '        unidade_nome,\n' +
    at <unknown> (.next/server/chunks/[root-of-the-server]__e214de29._.js:27:17)
    '\n' +
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
    '        COUNT(CASE \n' +
    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    '          WHEN dt_atendimento IS NULL \n' +
    at s (.next/server/chunks/[root-of-the-server]__e214de29._.js:1:1777) {
    "               AND status NOT LIKE 'Finalizado%' \n" +
  code: 'ER_PARSE_ERROR',
  errno: 1064,
  sql: '\n' +
    '      SELECT \n' +
    '\n' +
[MEDIC API ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')
    '      FROM recepcao_historico\n' +
    '      WHERE dia_referencia = CURDATE()\n' +
    '        CAST(ROUND(AVG(\n' +
    '      GROUP BY unidade_id, unidade_nome\n' +
    '          CASE \n' +
    '\n' +
    '    ',
    '            WHEN dt_atendimento IS NOT NULL \n' +
  sqlState: '42000',
    '        COUNT(CASE \n' +
    '            THEN (julianday(dt_atendimento) - julianday(dt_chegada)) * 1440\n' +
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,\n" +
    "          WHEN dt_atendimento IS N' at line 16"
    '          END\n' +
}
    '        )) AS INTEGER) AS tempo_medio,\n' +
    '\n' +
    '        COUNT(CASE \n' +
    '          WHEN dt_atendimento IS NOT NULL \n' +
    '          THEN 1 END\n' +
    '        ) AS total_passaram\n' +
      ORDER BY
      ' at line 4
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    at <unknown> (.next/server/chunks/[root-of-the-server]__6f193777._.js:9:16)
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    at d (.next/server/chunks/[root-of-the-server]__6f193777._.js:1:1986) {
  code: 'ER_PARSE_ERROR',
  errno: 1064,
  sql: '\n' +
    '      SELECT hash_id, unidade, paciente, chegada, espera_minutos, status, profissional, updated_at\n' +
    '      FROM espera_medica\n' +
    "      WHERE status NOT LIKE 'Finalizado%'\n" +
    "        AND datetime(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
    "        CASE WHEN status = 'Em Atendimento' THEN 0 ELSE 1 END,\n" +
    "        datetime(updated_at, '+3 hours') DESC\n" +
    '    ',
  sqlState: '42000',
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
    "      ' at line 4"
}

[MEDIC API ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')
      ORDER BY
      ' at line 4
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    '      SELECT hash_id, unidade, paciente, chegada, espera_minutos, status, profissional, updated_at\n' +
    at <unknown> (.next/server/chunks/[root-of-the-server]__6f193777._.js:9:16)
    '      FROM espera_medica\n' +
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    at d (.next/server/chunks/[root-of-the-server]__6f193777._.js:1:1986) {
  code: 'ER_PARSE_ERROR',
  errno: 1064,
  sql: '\n' +
    "        AND datetime(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
    "      WHERE status NOT LIKE 'Finalizado%'\n" +
  sqlState: '42000',
}
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
        COUNT(CASE 
    "      ' at line 4"
          WHEN dt_atendimento IS N' at line 16
[RECEPTION ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    at <unknown> (.next/server/chunks/[root-of-the-server]__e214de29._.js:27:17)
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
  errno: 1064,
    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    '          CASE \n' +
    '        COUNT(CASE \n' +
  sql: '\n' +
    at s (.next/server/chunks/[root-of-the-server]__e214de29._.js:1:1777) {
    '            WHEN dt_atendimento IS NOT NULL \n' +
    '      SELECT \n' +
  code: 'ER_PARSE_ERROR',
    '        ) AS fila,\n' +
    '          WHEN dt_atendimento IS NULL \n' +
    '        unidade_id,\n' +
    '\n' +
    "               AND status NOT LIKE 'Finalizado%' \n" +
    '        unidade_nome,\n' +
    '            THEN (julianday(dt_atendimento) - julianday(dt_chegada)) * 1440\n' +
    '        CAST(ROUND(AVG(\n' +
    '\n' +
    '          END\n' +
    "        CASE WHEN status = 'Em Atendimento' THEN 0 ELSE 1 END,\n" +
    "        datetime(updated_at, '+3 hours') DESC\n" +
    '    ',
    '          THEN 1 END\n' +
    '        )) AS INTEGER) AS tempo_medio,\n' +
    '\n' +
    '        COUNT(CASE \n' +
    '          WHEN dt_atendimento IS NOT NULL \n' +
    '          THEN 1 END\n' +
    '        ) AS total_passaram\n' +
    '\n' +
    '      FROM recepcao_historico\n' +
    '      WHERE dia_referencia = CURDATE()\n' +
    '      GROUP BY unidade_id, unidade_nome\n' +
    '    ',
  sqlState: '42000',
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,\n" +
    '\n' +
    '        COUNT(CASE \n' +
    "          WHEN dt_atendimento IS N' at line 16"
}

    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    at s (.next/server/chunks/[root-of-the-server]__e214de29._.js:1:1777) {
[RECEPTION ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,
  code: 'ER_PARSE_ERROR',
        COUNT(CASE 
          WHEN dt_atendimento IS N' at line 16
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    at <unknown> (.next/server/chunks/[root-of-the-server]__e214de29._.js:27:17)
    '\n' +
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
  errno: 1064,
  sql: '\n' +
    '      SELECT \n' +
    '        unidade_id,\n' +
    '        unidade_nome,\n' +
[MEDIC API ERROR] Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')
      ORDER BY
      ' at line 4
    at T.query (.next/server/chunks/_4836f51f._.js:5:252295)
    at Object.query (.next/server/chunks/_4836f51f._.js:14:1280)
    at <unknown> (.next/server/chunks/[root-of-the-server]__6f193777._.js:9:16)
    at <unknown> (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1234)
    at r (.next/server/chunks/[root-of-the-server]__eec9c0a0._.js:1:1280)
    at d (.next/server/chunks/[root-of-the-server]__6f193777._.js:1:1986) {
  code: 'ER_PARSE_ERROR',
  errno: 1064,
  sql: '\n' +
    '      SELECT hash_id, unidade, paciente, chegada, espera_minutos, status, profissional, updated_at\n' +
    '      FROM espera_medica\n' +
    "      WHERE status NOT LIKE 'Finalizado%'\n" +
    "        AND datetime(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
    "        CASE WHEN status = 'Em Atendimento' THEN 0 ELSE 1 END,\n" +
    "        datetime(updated_at, '+3 hours') DESC\n" +
    '    ',
  sqlState: '42000',
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(updated_at, '+3 hours') >= datetime('now', '-60 minutes')\n" +
    '      ORDER BY\n' +
    "      ' at line 4"
}
    '        COUNT(CASE \n' +
    '          WHEN dt_atendimento IS NULL \n' +
    "               AND status NOT LIKE 'Finalizado%' \n" +
    '          THEN 1 END\n' +
    '        ) AS fila,\n' +
    '\n' +
    '        CAST(ROUND(AVG(\n' +
    '          CASE \n' +
    '            WHEN dt_atendimento IS NOT NULL \n' +
    '            THEN (julianday(dt_atendimento) - julianday(dt_chegada)) * 1440\n' +
    '          END\n' +
    '        )) AS INTEGER) AS tempo_medio,\n' +
    '\n' +
]
    '        COUNT(CASE \n' +
    '          WHEN dt_atendimento IS NOT NULL \n' +
    '          THEN 1 END\n' +
[KPI_ENGINE] Agregação por SOMA: 10392.36
    '        ) AS total_passaram\n' +
    '\n' +
[KPI_ENGINE] Query retornou 1 linhas para kpi=sales. Amostra: [ { d: '2026-02', val: 9792.060000000009 } ]
[KPI_ENGINE] Agregação por SOMA: 9792.06
    '      FROM recepcao_historico\n' +
  { d: '2026-02-05', val: 872.28 }
    '      WHERE dia_referencia = CURDATE()\n' +
[KPI_ENGINE] Query retornou 6 linhas para kpi=agendamentos. Amostra: [
]
    '      GROUP BY unidade_id, unidade_nome\n' +
    '    ',
  { d: '2026-02-01', val: 7 },
  { d: '2026-02-02', val: 1831.55 },
  sqlState: '42000',
  sqlMessage: "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER) AS tempo_medio,\n" +
  { d: '2026-02-02', val: 325 },
  { d: '2026-02-03', val: 679.8 },
]
  { d: '2026-02-05', val: 1842.99 }
  { d: '2026-02-03', val: 320 },
[KPI_ENGINE] Agregação por SOMA: 13222.45
]
  { d: '2026-02-04', val: 337 }
[KPI_ENGINE] Query retornou 5 linhas para kpi=revenue. Amostra: [
]
[KPI_ENGINE] Agregação por SOMA: 9104.03
  { d: '2026-02-02', val: 1211.34 },
[KPI_ENGINE] Agregação por SOMA: 1408.00
[KPI_ENGINE] Query retornou 5 linhas para kpi=revenue. Amostra: [
  { d: '2026-02-03', val: 3392.61 },
  { d: '2026-02-03', val: 4538.010000000001 },
[KPI_ENGINE] Query retornou 5 linhas para kpi=revenue. Amostra: [
  { d: '2026-02-04', val: 2843.3 },
  { d: '2026-02-02', val: 1293.2 },
  { d: '2026-02-03', val: 2007.42 },
  { d: '2026-02-04', val: 5347.25 }
  { d: '2026-02-04', val: 2358.2 },
    '\n' +
    '        COUNT(CASE \n' +
  { d: '2026-02-05', val: 4341.52 }
    "          WHEN dt_atendimento IS N' at line 16"
[KPI_ENGINE] Agregação por SOMA: 4354.34
  { d: '2026-02-02', val: 2717.11 },
]
}
[KPI_ENGINE] Agregação por SOMA: 11634.04
[KPI_ENGINE] Query retornou 5 linhas para kpi=revenue. Amostra: [
[KPI_ENGINE] Iniciando cálculo: revenue | Período: 2026-02-01 a 2026-02-28 | Escopo: CLINIC
  { d: '2026-02-03', val: 7028.330000000002 },
[KPI_ENGINE] Query retornou 5 linhas para kpi=revenue. Amostra: [
[KPI_ENGINE] Iniciando cálculo: revenue | Período: 2026-02-01 a 2026-02-28 | Escopo: CLINIC
  { d: '2026-02-02', val: 1850.25 },
[KPI_ENGINE] Iniciando cálculo: revenue | Período: 2026-02-01 a 2026-02-28 | Escopo: CLINIC
  { d: '2026-02-04', val: 3732.73 },
  { d: '2026-02-02', val: 1338.63 },
[KPI_ENGINE] Iniciando cálculo: agendamentos | Período: 2026-02-01 a 2026-02-28 | Escopo: CLINIC
  { d: '2026-02-03', val: 4726.55 },
  { d: '2026-02-05', val: 4747.729999999999 }
[KPI_ENGINE] Iniciando cálculo: sales | Período: 2026-02-01 a 2026-02-28 | Escopo: CARD
  { d: '2026-02-03', val: 3523.33 },
[KPI_ENGINE] Iniciando cálculo: revenue | Período: 2026-02-01 a 2026-02-28 | Escopo: CLINIC
  { d: '2026-02-04', val: 1031.63 },